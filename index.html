 <!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="https://use.typekit.net/vjm3isi.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

<meta charset="UTF-8" />
<title></title>
<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
<style>
body,html{
    background-color: black;
    position: absolute;
    width: 100%;
    height: 100%;
    overflow: hidden;
}
/*Dazzle Unicase Light
font-family: "dazzle-unicase", sans-serif;
font-weight: 300;
font-style: normal;
Dazzle Unicase Bold*/
*{
    margin: 0;
    box-sizing: border-box;
    font-family: "dazzle-unicase", sans-serif;
    font-weight: 700;
    font-style: normal;
    font-size: 2vh;
}
*{
  font-family: "Roboto", sans-serif;
  font-optical-sizing: auto;
  font-weight: <weight>;
  font-style: normal;
  font-variation-settings:
    "wdth" 100;
}
/**{
  font-family: "JetBrains Mono", monospace;
  font-optical-sizing: auto;
  font-weight: 800;
  font-style: normal;
}*/
.wrap{
    position: absolute;
    left: 0;
    top: 0;
    height: 100%;
    left: 50%;
    transform:translateX(-50%);
}
.wrap img{
    height: 100%;
    position: relative;
    left: 0;
    top: 0;
    /*opacity: 0.5*/
}
.side,.sideextra{
    position: absolute;
    left: 50%;
    top: 0;
    /* background: #ff00005e; */
    height: 21.6%;
    width: 12.5%;
    transform-origin: left top;
    overflow: hidden;
    background-image: url(basic_img/plus.png);
    background-size: 10%;
    background-position: 50% 50%;
    background-repeat: no-repeat;
}
.sideextra_1{
    left: -12.25%;
    top: 10%;
    background-color: white;
    background-position: left center;
    /* z-index: 10000000000000; */
    transform: skewY(40deg);
    transform-origin: right}
.sideextra_2{
    left: 99%;
    top: 10%;
    background-color: white;
    background-position: left center;
    /* z-index: 10000000000000; */
    transform: skewY(-40deg);
    transform-origin: left;}
.sidebottom{    position: absolute;
    perspective: 100vh;
    left: 50%;
    top: 0;
    background-image: url(basic_img/plus.png);
    background-size: 10%;
    background-position: 50% 35%;
    background-repeat: no-repeat;
    height: 21.6%;
    width: 12.5%;
    transform-origin: left top;
    overflow: visible;
}
.sidetop {
    position: absolute;
    left: 50%;
    top: 0;
    width: 12.5%;
    transform-origin: left top;
    height: 6vh;
    background-color: white;
    margin-top: -8vh;
    overflow: hidden;
}
.sidetop_hovered{
    z-index: 1000000;
    box-shadow: 0vh 0vh 0vh 1vh red;
}
.sidebottom.side_1 .background_image_wrap{
    display: none;
}
.sidebottom.side_2 .background_image_wrap{
    display: none;
}
.sidebottom.side_3 .background_image_wrap{
    display: none;
}
.sidebottom.side_9 .background_image_wrap{
    display: none;
}
.sidebottom.side_10 .background_image_wrap{
    display: none;
}
.sidebottom.side_11 .background_image_wrap{
    display: none;
}
.side_1{
    left: 0.2%;
    top: 12%;
    transform: scaleX(0.17) skewY(35deg);
}
.side_2{
    left: 2.3%;
    top: 26.1%;
    transform: scaleX(0.46) skewY(33deg)
}
.side_3{    
    left: 8.05%;
    top: 39.3%;
    transform: scaleX(0.735) skewY(28.6deg)
}
.side_4{    
    left: 17.2%;
    top: 50.3%;
    transform: scaleX(0.95) skewY(21.2deg);
}
.side_5{    
    left: 29.1%;
    top: 58.2%;
    transform: scaleX(1.08) skewY(11.8deg);
}
.side_6{    
    left: 42.6%;
    top: 62.4%;
    transform: scaleX(1.125) skewY(0deg);
}
.side_7{    
    left: 56.66%;
    top: 62.4%;
    transform: scaleX(1.08) skewY(-11.8deg)
}
.side_8{      
    left: 70.18%;
    top: 58.2%;
    transform: scaleX(0.95) skewY(-21.2deg)
}
.side_9{ 
    left: 82.05%;
    top: 50.3%;
    transform: scaleX(0.735) skewY(-28.6deg)
}
.side_10{ 
    left: 91.25%;
    top: 39.2%;
    transform: scaleX(0.46) skewY(-33deg);
}
.side_11{ 
    left: 97%;
    top: 26%;
    transform: scaleX(0.17) skewY(-35deg);
}
.turnOn .sidebottom.side_1{transform: scaleX(0.17) skewY(35deg) translateY(100%)}
.turnOn .sidebottom.side_2{transform: scaleX(0.46) skewY(33deg) translateY(100%)}
.turnOn .sidebottom.side_3{transform: scaleX(0.735) skewY(28.6deg) translateY(100%)}
.turnOn .sidebottom.side_4{transform: scaleX(0.95) skewY(21.2deg) translateY(100%)}
.turnOn .sidebottom.side_5{transform: scaleX(1.08) skewY(11.8deg) translateY(100%)}
.turnOn .sidebottom.side_6{transform: scaleX(1.125) skewY(0deg) translateY(100%)}
.turnOn .sidebottom.side_7{transform: scaleX(1.08) skewY(-11.8deg) translateY(100%)}
.turnOn .sidebottom.side_8{transform: scaleX(0.95) skewY(-21.2deg) translateY(100%)}
.turnOn .sidebottom.side_9{transform: scaleX(0.735) skewY(-28.6deg) translateY(100%)}
.turnOn .sidebottom.side_10{transform: scaleX(0.46) skewY(-33deg) translateY(100%)}
.turnOn .sidebottom.side_11{transform: scaleX(0.17) skewY(-35deg) translateY(100%)}
.side_1 .artistname_wrap,
.side_2 .artistname_wrap,
.side_3 .artistname_wrap,
.side_4 .artistname_wrap,
.side_5 .artistname_wrap{
    box-shadow: black -100vw 0vh 0vh 100vw;
}
.side_7 .artistname_wrap,
.side_8 .artistname_wrap,
.side_9 .artistname_wrap,
.side_10 .artistname_wrap,
.side_11 .artistname_wrap{
    box-shadow: black 100vw 0vh 0vh 100vw;
}
.side_1 .artistname_wrap {
    margin-left: 0%;
}
.side_2 .artistname_wrap {
    margin-left: -100%;
}
.side_3 .artistname_wrap {
    margin-left: -200%;
}
.side_4 .artistname_wrap {
    margin-left: -300%;
}
.side_5 .artistname_wrap {
    margin-left: -400%;
}
.side_6 .artistname_wrap {
    margin-left: -500%;
}
.side_7 .artistname_wrap {
    margin-left: -600%;
}
.side_8 .artistname_wrap {
    margin-left: -700%;
}
.side_9 .artistname_wrap {
    margin-left: -800%;
}
.side_10 .artistname_wrap {
    margin-left: -900%;
}
.side_11 .artistname_wrap {
    margin-left: -1000%;
}
.side_12 .artistname_wrap {
    margin-left: -1100%;
}
.side_1 .background_image_wrap {
    margin-left: 0%;
}
.side_2 .background_image_wrap {
    margin-left: -100%;
}
.side_3 .background_image_wrap {
    margin-left: -200%;
}
.side_4 .background_image_wrap {
    margin-left: -300%;
}
.side_5 .background_image_wrap {
    margin-left: -400%;
}
.side_6 .background_image_wrap {
    margin-left: -500%;
}
.side_7 .background_image_wrap {
    margin-left: -600%;
}
.side_8 .background_image_wrap {
    margin-left: -700%;
}
.side_9 .background_image_wrap {
    margin-left: -800%;
}
.side_10 .background_image_wrap {
    margin-left: -900%;
}
.side_11 .background_image_wrap {
    margin-left: -1000%;
}
.side_12 .background_image_wrap {
    margin-left: -1100%;
}
.background_image{
    width: 100%;
    height: 100%;
    position: absolute;
    left: 0;
    top: 0;
    background-size: cover;
    background-position: center;
}










.background_image_wrap_1{ left: 0%}
.background_image_wrap_2{ left: 100%}
.background_image_wrap_3{ left: 200%}
.background_image_wrap_4{ left: 300%}
.background_image_wrap_5{ left: 400%}
.background_image_wrap_6{ left: 500%}
.background_image_wrap_7{ left: 600%}
.background_image_wrap_8{ left: 700%}
.background_image_wrap_9{ left: 800%}
.background_image_wrap_10{left: 900%}
.background_image_wrap_11{left: 1000%}
.background_image_wrap_12{left: 1100%}
.background_image_wrap_13{left: 1200%}
.background_image_wrap_14{left: 1300%}



.background_image_1{ background-image: url(artwork_img/Rimbawan.png);}
.background_image_2{ background-image: url(artwork_img/American.png);}
.background_image_3{ background-image: url(artwork_img/Ryank.png);}
.background_image_4{ background-image: url(artwork_img/Or.png);}
.background_image_5{ background-image: url(artwork_img/Ryanc.png);}
.background_image_6{ background-image: url(artwork_img/Tiri.png);}
.background_image_7{ background-image: url(artwork_img/Jen.png);}
.background_image_8{ background-image: url(artwork_img/Alice.png);}
.background_image_9{ background-image: url(artwork_img/Herdimas.png);}
.background_image_10{background-image: url(artwork_img/Chia.png);}
.background_image_11{background-image: url(artwork_img/Ho.png);}
.background_image_12{ background-image:url(artwork_img/Bani.png);}
.background_image_13{background-image: url(artwork_img/Samson.png);}
.background_image_14{background-image: url(artwork_img/Tega.png);}

.bar{
    background: transparent;
    width : 5%;
    height: 100%;
    display : inline-block;
    float:left;
    position: relative;
    z-index: 10;
    bottom: 0;
    top: auto;
    transition: opacity 0.5s;
    /*opacity: 0*/
}
.bar_wrap{
    pointer-events: none;
}
.sidebottom .bar_wrap{
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
}
.side .background_image_wrap{
    /*padding-right: 850%;*/
    position: relative;
}
.side .background_image_wrap,
.sidebottom .background_image_wrap{
    opacity: 0.3;
}
.turnOn .side .background_image_wrap,
.turnOn .sidebottom .background_image_wrap{
    transition: opacity 1s transform 0.5s;
    opacity: 1;
}
.turnOn .side_1 .background_image_wrap{opacity: 0.2}
.turnOn .side_2 .background_image_wrap{opacity: 0.4}
.turnOn .side_3 .background_image_wrap{opacity: 0.6}
.turnOn .side_4 .background_image_wrap{opacity: 0.8}
.turnOn .side_8 .background_image_wrap{opacity: 0.8}
.turnOn .side_9 .background_image_wrap{opacity: 0.6}
.turnOn .side_10 .background_image_wrap{opacity: 0.4}
.turnOn .side_11 .background_image_wrap{opacity: 0.2}
.turnOn .sidebottom.side_4 .background_image_wrap{opacity: 0.3}
.turnOn .sidebottom.side_5 .background_image_wrap{opacity: 0.6}
.turnOn .sidebottom.side_7 .background_image_wrap{opacity: 0.6}
.turnOn .sidebottom.side_8 .background_image_wrap{opacity: 0.3}
.bar_init{
    height: 100%;
    width: 7.1428%;
}
.artistname_wrap,.background_image_wrap{
    transition: transform 0.5s;
    width: 1400%;
    height: 100%;
    position: relative;
}
.artistname{
    float: left;
    width: 7.1428%;
    height: 100%;
    text-align: center;
    line-height: 1;
    background-color: white;
    cursor: pointer;
}
.title{
    font-size: 10vw;
    line-height: 1;
    width: 100%;
    text-align: center;
    color: white;
    position: absolute;
    left: 0;
    top:0;
    z-index: 1;
    text-transform: uppercase;
    font-family: "dazzle-unicase", sans-serif;
    font-weight: 700;
    font-style: normal;
}
.info_bar{ 
    position: absolute;
    z-index: 1000000000000000;
    left: 49.5%;
    transform: translateX(-50%);
    background-color: white;
    /* height: 54%; */
    /* padding-top: 15vw; */
    text-align: center;
    font-size: 1.5vh;
    /* mix-blend-mode: difference; */
    width: 52.7vh;
    margin-top: 10vw;
}
.oval_following{
    left: 100%;
    top: 100%;
    position: absolute;
    background-color: white;
    mix-blend-mode: difference;
    width: 30vh;
}

.oval_following, .oval_following *{
    font-size: 1.5vh;
    line-height: 1.2;
}

.turnOn .oval_following{
    opacity: 0;
}
.ovalDiv_img:hover .oval_following{
    opacity: 1;
}
.oval_following *{
    font-size: 1.5vh;}
.info_bar *{
    font-size: 1.5vh !important;
}
.popup{
    z-index: 1000000;
    position: absolute;
    background: wheat;
    width: 100vh;
    left: calc(50vw - 50vh);
    top: 2.5vh;
    padding: 1vh;
    height: 95vh;
    overflow-y: scroll;
    box-shadow: 0vh 0vh 2vh black;
    display: none;
}
.arrow{
    position: absolute;
    z-index: 10000;
    height: 10vh;
    top: 20vh;
filter: invert(1);}
.arrow:hover{
    filter: invert(0);
}
.artistname:hover{
filter: invert(1);
}
.background_image_wrap:hover{
filter: invert(1);
}
.arrow_r{
    right: 0;}
    .arrow_l{
        transform: scaleX(-1);
    left: 0;

    }
.close{
    position: absolute;
    right: 0;
    top: 0;
    left: auto;
    width: 5vh;
    top: 1vh;
    right: 1vh;
    cursor: pointer;
}
.close:hover{
    filter: invert(1);
}
.popup_title{
    font-size: 5vh;
    text-align: center;
    line-height: 1.2;
    width: 100%;}
    .popup_artist{
        text-align: center;
    }
    .popup_img{
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
        background-color: white;
    }
    .work_link{
    padding: 1vh;
    border: 1px solid black;
    border-radius: 10px;
    left: 50%;
    position: relative;
    /* width: 5vh; */
    display: inline-block;
    transform: translateX(-50%);
    background-color: white;
    margin: 1vh;}
    .popup_des{
    font-family: "elza-text", sans-serif;
    font-weight: 400;
    font-style: normal;
    font-size: 2.5vh;
    letter-spacing: -0.025vh;
    }

    .ovalDiv {
        pointer-events: none;
    mix-blend-mode: exclusion;
      boz-shadow:0vh 0vh 7.5vh white;
        transition: 1s box-shadow;
        box-shadow: 0vh 0vh 15vh 15vh white, 0vh 0vh 0vh 100vw #3d3d3d00;
    }
    .ovalDiv_img,.ovalDiv {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      transform: translate(-50%, -50%);
      position: absolute;
      z-index: 100000;
  }
    .ovalDiv_img{
      background-size: auto 100%;
      background-position: center;
      background-repeat: no-repeat;
    }
     .ovalDiv.shadow{
    transition: 0s box-shadow;
    box-shadow: 0vh 0vh 15vh 15vh white, 0vh 0vh 0vh 100vw #3d3d3d;
    transition: opacity 1s;
    filter: invert(1);
}
.turnOn .ovalDiv.shadow{
    opacity: 0;
}
    .ovalDiv_sun_img{
    z-index: 1000000000;
      background-image: url(basic_img/sun.png);
    }
    .ovalDiv_moon_img{
    z-index: 100000000000;
      background-image: url(basic_img/moon.png);
    }
    .perspective_wrap{
    width: 100%;
    height: 100%;
    left: 0;
    position: absolute;
    top: 0;
    transform-origin: left top;
    overflow: hidden;}
    .sidebottom.side_9 .perspective_wrap{
    transform-origin: left top;
    /*background: #339981;*/
    transform: rotateX(-30deg) skewX(-24.5deg) scaleY(0.76);
}
    .sidebottom.side_8 .perspective_wrap{
    transform: rotateX(-36deg) skewX(-12deg) scaleY(0.92);
    }
    .sidebottom.side_7 .perspective_wrap{
    transform: rotateX(-29deg) skewX(-5deg) scaleY(0.88);
}
    .sidebottom.side_6 .perspective_wrap{
    transform-origin: center top;
    background: #339981;
    transform: rotateX(-20deg) scaleY(0.81);
}
.sidebottom.side_5 .perspective_wrap{
    transform: rotateX(-29deg) skewX(5deg) scaleY(0.88);
    transform-origin: right top;
}
    .sidebottom.side_4 .perspective_wrap{
    transform: rotateX(-36deg) skewX(12deg) scaleY(0.92);
    transform-origin: right top;
    }

#ovalRoute{
    position: absolute;
    transform: translate(-50%, -50%);
    border: 1px solid white;
    z-index: 1;
    border-radius: 50% 50%;
    pointer-events: none;
}
.bar_wrap{
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;}
</style>
</head>
<body>
<div class="ovalDiv_moon_img ovalDiv_img">
  <div class="oval_following">
    ‚Äì Current Server Name: <span class="sp-name"></span><br>
    ‚Äì Location: <span class="sp-loc"></span><br>
    ‚Äì Battery Level: <span class="sp-bat"></span><br>
    ‚Äì Time There: <span class="sp-time"></span><br>
    </div>
</div>
  <div class="ovalDiv ovalDiv_moon">
</div>
    <div class="ovalDiv_img ovalDiv_sun_img">
  <div class="oval_following">
    ‚Äì Current Server: <span class="sp-name"></span><br>
    ‚Äì Site (City/Country): <span class="sp-loc"></span><br>
    ‚Äì Battery Level: <span class="sp-bat"></span><br>
    ‚Äì Time There: <span class="sp-time"></span><br>
    </div></div>
  <div class="ovalDiv ovalDiv_sun">
</div>
  <div id="ovalRoute"></div>
    <div class="title">Open Systems 3</div>
    <div class="info_bar">
    This website is hosted across a network of solar powered servers and is sent to you from whichever server is in the most sunshine.
</div>
The File is a stack of technical documentation about itself. It begins as a discussion on the contingency of digital files and grows into a cipher for the artist-worker."</div>
</div>
<img class="arrow_r arrow" src="basic_img/arrow.jpg">
<img class="arrow_l arrow" src="basic_img/arrow.jpg">

<div class="wrap">
    <img src="basic_img/background.png">
    <div class="barhide side side_1"> <div class="bar_wrap"></div></div>
    <div class="barhide side side_3"> <div class="bar_wrap"></div></div>
    <div class="barhide side side_2"> <div class="bar_wrap"></div></div>
    <div class="barhide side side_4"> <div class="bar_wrap"></div></div>
    <div class="barhide side side_5"> <div class="bar_wrap"></div></div>
    <div class="barhide side side_6"> <div class="bar_wrap"></div></div>
    <div class="barhide side side_7"> <div class="bar_wrap"></div></div>
    <div class="barhide side side_8"> <div class="bar_wrap"></div></div>
    <div class="barhide side side_9"> <div class="bar_wrap"></div></div>
    <div class="barhide side side_10"><div class="bar_wrap"></div></div>
    <div class="barhide side side_11"><div class="bar_wrap"></div></div>

    <!-- <div class="sideextra sideextra_1"><div class="bar_wrap"></div></div> -->
    <!-- <div class="sideextra sideextra_2"><div class="bar_wrap"></div></div> -->

    <div class="barhide sidebottom side_1" ><div class="perspective_wrap"></div></div>
    <div class="barhide sidebottom side_3" ><div class="perspective_wrap"></div></div>
    <div class="barhide sidebottom side_2" ><div class="perspective_wrap"></div></div>
    <div class="barhide sidebottom side_4" ><div class="perspective_wrap"></div></div>
    <div class="barhide sidebottom side_5" ><div class="perspective_wrap"></div></div>
    <div class="barhide sidebottom side_6" ><div class="perspective_wrap"></div></div>
    <div class="barhide sidebottom side_7" ><div class="perspective_wrap"></div></div>
    <div class="barhide sidebottom side_8" ><div class="perspective_wrap"></div></div>
    <div class="barhide sidebottom side_9" ><div class="perspective_wrap"></div></div>
    <div class="barhide sidebottom side_10"><div class="perspective_wrap"></div></div>
    <div class="barhide sidebottom side_11"><div class="perspective_wrap"></div></div>
<!-- <div class="background_image_wrap"> -->
    <div class="barhide sidetop side_1"></div>
    <div class="barhide sidetop side_2"></div>
    <div class="barhide sidetop side_3"></div>
    <div class="barhide sidetop side_4"></div>
    <div class="barhide sidetop side_5"></div>
    <div class="barhide sidetop side_6 sidetop_hovered"></div>
    <div class="barhide sidetop side_7"></div>
    <div class="barhide sidetop side_8"></div>
    <div class="barhide sidetop side_9"></div>
    <div class="barhide sidetop side_10"></div>
    <div class="barhide sidetop side_11"></div>
<!-- </div> -->
<script>
    var tick_init = true
function easeInOutSine(x){
return x === 0 ? 0 : Math.pow(2, 10 * x - 10);
}

(function () {
  // update all matching elements by class
  function setTextAll(cls, text) {
    const els = document.getElementsByClassName(cls);
    for (let i = 0; i < els.length; i++) els[i].textContent = text;
  }

  const V2 = 'https://solarprotocol.net/api/v2/opendata.php';
  const V1 = 'https://solarprotocol.net/api/v1/opendata.php';

  // robust systemInfo fetcher: tries v2 JSON then v1 text; accepts {key:..} or {value:..}
  async function sys(key) {
    const urls = [`${V2}?systemInfo=${encodeURIComponent(key)}`, `${V1}?systemInfo=${encodeURIComponent(key)}`];
    for (const u of urls) {
      try {
        const r = await fetch(u, { cache: 'no-store' });
        if (!r.ok) continue;
        if (u.includes('/v2/')) {
          const j = await r.json();
          const val = (j && (j[key] ?? j.value)) ?? '';
          if (String(val).trim() !== '') return String(val).trim();
        } else {
          const t = (await r.text()).replace(/["\n\r]/g, '').trim();
          if (t) return t;
        }
      } catch (_) {}
    }
    return '';
  }

  // robust value fetcher (e.g., battery-percentage)
  async function val(key) {
    const urls = [`${V2}?value=${encodeURIComponent(key)}`, `${V1}?value=${encodeURIComponent(key)}`];
    for (const u of urls) {
      try {
        const r = await fetch(u, { cache: 'no-store' });
        if (!r.ok) continue;
        const j = await r.json();
        const v = j[key] ?? j.value ?? null;
        if (v != null) return v;
      } catch (_) {}
    }
    return null;
  }

  let tz = ''; // timezone string for Intl

  async function boot() {
    // 1) metadata
    const [name, location, city, country, bat] = await Promise.all([
      sys('name'), sys('location'), sys('city'), sys('country'), val('battery-percentage')
    ]);

    const locText = (location && location.trim()) || (city && country ? `${city}, ${country}` : '');

    setTextAll('sp-name', name || '‚Äî');
    setTextAll('sp-loc',  locText || '‚Äî');
    if (bat != null) setTextAll('sp-bat', `${bat}%`);

    // 2) timezone ‚Üí start clock + animations
    tz = await sys('tz') || 'UTC';
    tick();
    setInterval(tick, 1000);

    // 3) refresh server + tz every 5 min (active server can change)
    setInterval(async () => {
      try {
        const [n2, l2, c2, co2] = await Promise.all([sys('name'), sys('location'), sys('city'), sys('country')]);
        const loc2 = (l2 && l2.trim()) || (c2 && co2 ? `${c2}, ${co2}` : '');
        setTextAll('sp-name', n2 || '‚Äî');
        setTextAll('sp-loc',  loc2 || '‚Äî');
        const tz2 = await sys('tz');
        if (tz2) tz = tz2;
      } catch (e) {
        console.warn('[SP] refresh failed', e);
      }
    }, 5 * 60 * 1000);

    // quick inspect
    window.SP_DEBUG = { name, location: locText, battery: bat, tz };
    console.debug('[SP]', window.SP_DEBUG);
  }

  function tick() {
    if (!tz) return;

    const parts = new Intl.DateTimeFormat(undefined, {
      timeZone: tz, hour: '2-digit', minute: '2-digit', second: '2-digit', hourCycle: 'h23'
    }).formatToParts(new Date());

    let h = 0, m = 0, s = 0;
    for (const p of parts) {
      if (p.type === 'hour')   h = parseInt(p.value, 10);
      if (p.type === 'minute') m = parseInt(p.value, 10);
      if (p.type === 'second') s = parseInt(p.value, 10);
    }

    setTextAll('sp-time', `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`);

    const secs  = h * 3600 + m * 60 + s;
    const angle = map(secs, 0, 86400, 0, 360) - 90;

    const sun      = document.getElementsByClassName('ovalDiv_sun')[0];
    const moon     = document.getElementsByClassName('ovalDiv_moon')[0];
    const sun_img  = document.getElementsByClassName('ovalDiv_sun_img')[0];
    const moon_img = document.getElementsByClassName('ovalDiv_moon_img')[0];

    // your gradient bar logic intact
    if (secs > 21600 && secs < 64800) {
      var sel = Math.round(map(angle, 0, 180, 20/2, (11-2)*20 - 20/2))+20;
      if((sel>180 || sel<40)){
        sel = sel +20
      }else if((sel>140 || sel<80)){
        sel = sel +8
      }
      for (var i = sel; i >= 1; i--) {
        let sml =  ((easeInOutSine((sel - i) / sel)) / 2) * 100/8;
        let big = (100 - ((easeInOutSine((sel - i) / sel)) / 2) * 100)/8;
        $('.bar_' + (sel - i)).css({ 'background': `linear-gradient(0deg, transparent ${50 - sml - 5}%, black ${50 - sml}%, black ${50 + sml}%, transparent ${50 + sml + 5}%)` });
      }
      for (var j = 1; j >= 0; j--) {
        let sml2 = ((easeInOutSine((j) / 20)) / 2) * 100/8/2;
        let big2 =( 100 - ((easeInOutSine((j) / 20)) / 2) * 100)/8/2;
        $('.bar_' + (sel + sel -  j)).css({ 'background': `linear-gradient(0deg, transparent ${50 - sml2 - 5}%, black ${50 - sml2}%, black ${50 + sml2}%, transparent ${50 + sml2 + 5}%)` });
      }
    }
    if (typeof tick_init !== 'undefined' && tick_init) {
      if ((angle+3600)%360 < 180) $('.ovalDiv_sun').addClass('shadow'); else $('.ovalDiv_moon').addClass('shadow');
      console.log(angle)
      setTimeout(() => { $('body').addClass('turnOn'); }, 1000);
      tick_init = false;
    }

    if (sun)      animate(angle, sun);
    if (moon)     animate(angle - 180, moon);
    if (sun_img)  animate(angle, sun_img);
    if (moon_img) animate(angle - 180, moon_img);

  }

  document.addEventListener('DOMContentLoaded', boot);
})();

function map(value, start1, stop1, start2, stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

    const centerX = window.innerWidth / 2;
    const centerY = window.innerHeight * 0.25;
    const radiusX = window.innerHeight * 0.5; // horizontal radius (ellipse width)
    const radiusY = window.innerHeight * 0.5; // vertical radius (ellipse height)
    const degToRad = (deg) => (deg) * Math.PI / 180;
$('#ovalRoute').css({'width':radiusX*2 +'px'})
$('#ovalRoute').css({'height':radiusY*2 +'px'})
$('#ovalRoute').css({'left':centerX +'px'})
$('#ovalRoute').css({'top':centerY +'px'})
    function animate(angle,elem) {
        const x = centerX + radiusX * Math.cos(degToRad(angle));
        const y = centerY + radiusY * Math.sin(degToRad(angle));
        elem.style.left = x + "px";
        elem.style.top = y + "px";
    }
$(document).ready(function() {
  let inactivityTimer;

  function startInactivityTimer() {
    inactivityTimer = setTimeout(function() {
      $('body').removeClass('turnOn');
    }, 6000); // 1 minute = 60000ms
  }

  function resetTimer() {
    clearTimeout(inactivityTimer);
    $('body').addClass('turnOn');
    startInactivityTimer();
  }

  $(document).on('mousemove', resetTimer);

  // Start the initial timer when page loads
  startInactivityTimer();
});





    $(document).ready(function(){


        $(function(){
  var h = $(".side").outerHeight();
  // center horizontally, use half the height for vertical center
  $(".sidebottom .background_image").css("background-position", "center " + "calc(50% - " + (h) + "px)");
  
  // optional: recalc on resize
  $(window).on("resize", function(){
    var h =  $(".side").outerHeight();
    $(".sidebottom .background_image").css("background-position", "center " + "calc(50% - " + (h) + "px)");
  });
});




for (var i = 1; i <= 14; i++) {
    $('.side').append('<div class="background_image_wrap background_image_wrap_'+i+'"><div class="background_image background_image_'+i+'"></div></div>')
}
for (var i = 1; i <= 14; i++) {
    $('.sidebottom').find('.perspective_wrap').append('<div class="background_image_wrap background_image_wrap_'+i+'"><div class="background_image background_image_'+i+'"></div></div>')
}
        
        var scroll_counter = 0

            scroll(scroll_counter)
            scroll_img(scroll_counter)
$('.sidetop').append('\
    <div class="artistname_wrap">\
        <div class="artistname artistname_1" >Rimbawan Gerilya</div>\
        <div class="artistname artistname_2" >American Artist</div>\
        <div class="artistname artistname_3" >Ryan Kuo</div>\
        <div class="artistname artistname_4" >Or Zubalsky</div>\
        <div class="artistname artistname_5" >Ryan Clarke</div>\
        <div class="artistname artistname_6" >Tiri Kananuruk and Sebastian Morales Prado</div>\
        <div class="artistname artistname_7" >Jen Liu</div>\
        <div class="artistname artistname_8" >Alice Yuan Zhang</div>\
        <div class="artistname artistname_9" >Herdimas Anggara</div>\
        <div class="artistname artistname_10">Chia Amisola</div>\
        <div class="artistname artistname_11">Ho Rui An</div>\
        <div class="artistname artistname_12">Bani Haykal</div>\
        <div class="artistname artistname_13">Samson Young</div>\
        <div class="artistname artistname_14">Tega Brain</div>\
    </div>\
    ')
$('.barhide').hover(function(){
    $('.bar').css({'opacity':0})
},function(){
    $('.bar').css({'opacity':1})
})
$('.sidetop').hover(function(){
    $('.sidetop').removeClass('sidetop_hovered')
    $(this).addClass('sidetop_hovered')
    var selected = parseInt($(this).attr('class').split('side_')[1].split(' ')[0])
    scroll_img(6-selected)
    $(this)
},function(){
    $(this).removeClass('sidetop_hovered')
    $('.sidetop.side_6').addClass('sidetop_hovered')
    scroll_img(scroll_counter)
})

$('.side_1 .background_image_wrap').click(function() { window.location.href  = 'detail/RimbawanGerilya.html'; });
$('.side_2 .background_image_wrap').click(function() { window.location.href  = 'detail/AmericanArtist.html'; });
$('.side_3 .background_image_wrap').click(function() { window.location.href  = 'detail/RyanKuo.html'; });
$('.side_4 .background_image_wrap').click(function() { window.location.href  = 'detail/OrZubalsky.html'; });
$('.side_5 .background_image_wrap').click(function() { window.location.href  = 'detail/RyanClarke.html'; });
$('.side_6 .background_image_wrap').click(function() { window.location.href  = 'detail/TiriKananurukandSebastianMoralesPrado.html'; });
$('.side_7 .background_image_wrap').click(function() { window.location.href  = 'detail/JenLiu.html'; });
$('.side_8 .background_image_wrap').click(function() { window.location.href  = 'detail/AliceYuanZhang.html'; });
$('.side_9 .background_image_wrap').click(function() { window.location.href  = 'detail/HerdimasAnggara.html'; });
$('.side_10 .background_image_wrap').click(function() { window.location.href = 'detail/ChiaAmisola.html'; });
$('.side_11 .background_image_wrap').click(function() { window.location.href = 'detail/HoRuiAn.html'; });
$('.side_12 .background_image_wrap').click(function() { window.location.href = 'detail/BaniHaykal.html'; });
$('.side_13 .background_image_wrap').click(function() { window.location.href = 'detail/SamsonYoung.html'; });
$('.side_14 .background_image_wrap').click(function() { window.location.href = 'detail/TegaBrain.html'; });

$('.artistname_1').click(function() { window.location.href =  'detail/RimbawanGerilya.html'; });
$('.artistname_2').click(function() { window.location.href =  'detail/AmericanArtist.html'; });
$('.artistname_3').click(function() { window.location.href =  'detail/RyanKuo.html'; });
$('.artistname_4').click(function() { window.location.href =  'detail/OrZubalsky.html'; });
$('.artistname_5').click(function() { window.location.href =  'detail/RyanClarke.html'; });
$('.artistname_6').click(function() { window.location.href =  'detail/TiriKananurukandSebastianMoralesPrado.html'; });
$('.artistname_7').click(function() { window.location.href =  'detail/JenLiu.html'; });
$('.artistname_8').click(function() { window.location.href =  'detail/AliceYuanZhang.html'; });
$('.artistname_9').click(function() { window.location.href =  'detail/HerdimasAnggara.html'; });
$('.artistname_10').click(function() { window.location.href = 'detail/ChiaAmisola.html'; });
$('.artistname_11').click(function() { window.location.href = 'detail/HoRuiAn.html'; });
$('.artistname_12').click(function() { window.location.href = 'detail/BaniHaykal.html'; });
$('.artistname_13').click(function() { window.location.href = 'detail/SamsonYoung.html'; });
$('.artistname_14').click(function() { window.location.href = 'detail/TegaBrain.html'; });

        $('.artistname_3').click(function(){
            $('.popup_3').show()
        })
        $('.close').click(function(){
            $(this).parent().hide()
        })
        $('.arrow_r').click(function(){
            scroll_counter--
            if(scroll_counter<-8){
                scroll_counter = -8
            }
            scroll(scroll_counter)
            scroll_img(scroll_counter)
            // scroll_sun()
        })
        $('.arrow_l').click(function(){
            scroll_counter++
            if(scroll_counter>5){
                scroll_counter = 5
            }
            scroll(scroll_counter)
            scroll_img(scroll_counter)
            // scroll_sun()
        })
        function scroll(selected){
            $('.artistname_wrap').css({'transform':'translateX('+(7.1428*selected)+'%)'})
            // $('.sidebottom .background_image_wrap').css({'transform':'translateX('+(7.1428*(scroll_counter-1))+'%) translateY('+(100*(scroll_counter+1))+'%)'})
        }
        function scroll_img(selected){
            $('.background_image_wrap').css({'transform':'translateX('+(7.1428*(selected-5))+'%) translateY('+(100*(selected-5))+'%)'})
        }
    })







const sideElements = document.querySelectorAll('.background_image_wrap');
let sunlightStrength = 0;
var lat = 0
var lon = 0
// üîÑ Fetch sunlight info using user's current location
async function fetchSunlightFromLocation() {
  try {
    navigator.geolocation.getCurrentPosition(async (position) => {
      lat = position.coords.latitude;
      lon = position.coords.longitude;

      const today = new Date().toISOString().split("T")[0];

      const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&daily=shortwave_radiation_sum,sunshine_duration&timezone=auto&start_date=${today}&end_date=${today}`;

      const res = await fetch(url);
      const data = await res.json();
      const watts = data.daily.shortwave_radiation_sum[0]; // MJ/m¬≤
      sunlightStrength = watts;

    });
  } catch (err) {
    console.error("Failed to get location or solar data", err);
  }
}
async function fetch4DayHourlyArchive(lat, lon) {
  const now = new Date();
  const endDate = now.toISOString().split("T")[0];

  const start = new Date();
  start.setDate(now.getDate() - 4); // get extra buffer in case of gaps
  const startDate = start.toISOString().split("T")[0];

  const url = `https://archive-api.open-meteo.com/v1/archive?latitude=${lat}&longitude=${lon}&start_date=${startDate}&end_date=${endDate}&hourly=shortwave_radiation&timezone=auto`;

  try {
    const res = await fetch(url);
    const data = await res.json();

    const time = data.hourly.time;
    const radiation = data.hourly.shortwave_radiation;

    // Combine time and value, filter out nulls
    const combined = time
      .map((t, i) => ({ time: t, value: radiation[i] }))
      .filter(entry => entry.value != null);

    // Slice the latest 72 entries (last 72 hours)
    const last72 = combined.slice(-80);

    console.log("‚òÄÔ∏è Last 72 Hours of Radiation (clean):", last72);
    return last72;
  } catch (e) {
    console.error("‚ùå Failed to fetch solar archive", e);
    return [];
  }
}

// üîÅ Add a bar every 5 seconds using sunlight strength
function addSunlightBar() {
  const height = sunlightStrength * 5; // Scale factor
  const bar = document.createElement("div");
  bar.className = "bar";
  bar.style.height = `${height}px`;

  sideElements.forEach((side) => {
    side.appendChild(bar.cloneNode(true));
  });
}

    for (var i = 11; i >= 1; i--) {
        for (var k = 20; k >= 0; k--) {
            const bar = document.createElement("div");
            bar.className = "bar bar_"+(k+((11-i)*20));
            // var bigval =Math.max(parent_height-(value * scalefactor),value * scalefactor)
            // var smlval = Math.min(parent_height-(value * scalefactor),value * scalefactor)
            // if(value>0){
            // bar.style.background = `
            // linear-gradient(0deg, black ${smlval}px, transparent ${smlval}px, 
            //                             transparent ${bigval}px, black ${bigval}px)`;
            //                         }else{
            // bar.style.background = `black`;
            //                         }
            
            // bar.title = `${solarData[i].time} ‚Üí ${value} W/m¬≤`;
            $('.side_'+i+' .bar_wrap').append(bar)
        }
    }


// *****Cannot get accurate solarData
// navigator.geolocation.getCurrentPosition(async (pos) => {
//   const lat = pos.coords.latitude;
//   const lon = pos.coords.longitude;

//   const solarData = await fetch4DayHourlyArchive(lat, lon);


// if (solarData && solarData.length >= 44) {
//     const values = solarData.map(entry => entry.value);
//     const maxValue = Math.max(...values);
//     const scalefactor = $('.background_image_wrap').outerHeight() / maxValue

//         var parent_height = $('.background_image_wrap').outerHeight()
//         console.log(parent_height)
//   // Loop through all 72 radiation values
//   for (let i = 44; i >= 0; i--) {
//     const value = solarData[i].value;
//         for (var k = 20; k >= 0; k--) {

//             const bar = document.createElement("div");
//             bar.className = "bar";
//             var bigval =Math.max(parent_height-(value * scalefactor),value * scalefactor)
//             var smlval = Math.min(parent_height-(value * scalefactor),value * scalefactor)
//             if(value>0){
//             bar.style.background = `
//             linear-gradient(0deg, black ${smlval}px, transparent ${smlval}px, 
//                                         transparent ${bigval}px, black ${bigval}px)`;
//                                     }else{
//             bar.style.background = `black`;
//                                     }
            
//             bar.title = `${solarData[i].time} ‚Üí ${value} W/m¬≤`;
//             $('.background_image_wrap').append(bar)
//         }
//   }
// }


//   solarData.forEach(entry => {
//     console.log(`${entry.time} ‚Üí ${entry.value} W/m¬≤`);
//   });
// });

// // üîÅ Start fetching every 60s
// fetchSunlightFromLocation();
// setInterval(fetchSunlightFromLocation, 60*60 * 1000);

// // üîÅ Add new bars every 5s
// setInterval(addSunlightBar, 5000);


</script>

</body>
</html>
